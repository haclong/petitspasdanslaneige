<!doctype html>
<html class="no-js" lang="fr" dir="ltr">
  
<head>

  <meta charset="utf-8">
  <title>Me revoilà sur les rails...&nbsp;|&nbsp;Petits Pas Dans La Neige</title>

  <meta name="description" content="Haclong&#39;s lair">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="Generator" content="Eleventy v2.0.1" />

  <link rel="icon" href="/favicon.ico" type="image/x-icon" />
  <!--link rel="shortlink" href="http://localhost:8080" /-->

  <link rel="stylesheet" href="/assets/styles/bootstrap.css">
  <link rel="stylesheet" href="/assets/styles/theme.css">

</head>

<body onscroll="checkscroll('header-top');">

    <header id="header">
    <div id="header-top">
      <div class="container-xl">
        <a href="/fr/">Français</a>
        <a href="/en/">Anglais</a>
      </div>
    </div>
    <div id="title-bar" class="container-xl d-flex align-items-center">
      <div class="flex-grow-1">
        <a href="/fr/" class="site-name">PETITS PAS DANS LA NEIGE</a>
        <div class="site-slogan">Haclong Home</div>
      </div>
      <i id="mobile-nav-trigger" class="fas fa-bars"></i>
      <nav id="nav" class="">
        <div id="mobile-nav-close">X</div>
        <a href="/fr/books/0/index.html">Séries</a>
        <a href="/fr/">Accueil</a>
      </nav>
    </div>
  </header>


  <main class="main">

    <!-- ----- DYNAMIC CONTENT : many articles + 1 pagination ----- -->

    <div id="content">
    
    <div id="breadcrumb">
      <div class="container-xl">
        <a href="/fr/">Accueil</a><i class="fas fa-angle-right"></i>Me revoilà sur les rails...
      </div>
    </div>


  <!-- Structure of the article -->
    <article class="article container-xl">
      <!--h2>Me revoilà sur les rails...</h2-->
      <div class="node-meta">
        <i class="fas fa-user"></i>haclong
        <i class="fas fa-calendar"></i>17/03/2024 14:10:00
        
        <i class="fas fa-th-large"></i><!--a href="/fr/sites/haclong-projects.html" class="tag-sites"-->Haclong projects<!--/a-->
      </div>

      <div class="node-banner">
        <img src="/img/teaser/bart-ros-RG2-rUfjR-0-unsplash.jpg" class="node-banner" />
        
          <p><strong>Crédit</strong> : Bart Ros - Unsplash </p>
        
      </div>

      <p><p>Me revoilà.</p>
<p>Un peu intimidée par le nouveau blog... Non, vous n'y voyez rien, j'ai gardé les mêmes couleurs, le même thème, par paresse principalement et puis parce qu'il me plaisait bien.</p>
<p>Exit donc Drupal et sa base de données. Trop gros, trop lourd pour mon modeste petit blog. Je suis repartie sur une base neuve, avec <a href="https://www.11ty.dev/" target="_blank">11ty</a></p>
<p>Il a fallu donc</p>
<h2>Préparer un bon vieux thème old school en html, css et javascript.</h2>
<p>Ca fait des années que je n'ai écrit ni de html, ni de css et encore moins du javascript... J'ai BIEN galéré et je ne suis pas prête de changer de thème là maintenant tout de suite...</p>
<h2>Extraire le contenu de Drupal</h2>
<p>Installer le module Json:API sur Drupal</p>
<p>Grâce à ce module, il est possible d'extraire le contenu (les nodes) de Drupal à cette adresse <code>http://{mon_domaine.ext}/jsonapi/node/{content_type_name}</code> pour les 50 premiers nodes et <code>http://{mon_domaine.ext}/jsonapi/node/{content_type_name}?page%5Boffset%5D=50&amp;page%5Blimit%5D=50</code></p>
<p>Vous récupérez à chaque fois 50 nodes au format json avec les dépendances et les références de chaque node Drupal (l'auteur, les dates, la référence aux fichiers média, les tags etc...). Bref, raisonnablement ce que je cherchais à obtenir.</p>
<h2>Créer un script python</h2>
<p>Comme 11ty fonctionne avec des fichiers markdown, il faut que je puisse transformer mes fichiers json extraits de Drupal, qui contiennent chacun 50 de mes articles de blog en 50 fichiers markdown distincts. Un fichier markdown par article de blog.</p>
<p>Il est également crucial de préparer les entêtes frontmatter qui vont servir à générer correctement les fichiers html statiques.</p>
<p>Je ne vous cache pas qu'il a fallu plusieurs essais. Il est donc crucial de ne pas saboter ses fichiers json qui sont finalement mon précieux contenu.</p>
<h2>Vérifier les fichiers html</h2>
<p>De la base de données Drupal, j'ai extrait le contenu en fichier json.</p>
<p>Des fichiers json, j'ai extrait le contenu en fichiers markdown.</p>
<p>Le générateur de fichiers statiques 11ty transforme ces fichiers markdown en fichier html.</p>
<p>Je vérifie que le contenu est correct. Il y a un GROS travail de réécriture et de nettoyage parce que les modules wysiwyg de Drupal ont laissé pas mal de balises html un peu pourries... De plus, même si Markdown a ses propres balises pour les liens hypertexte, il ne permet pas de faire des liens externes vers un nouvelle fenêtre. Je dois donc faire les liens hypertextes en bonne balise <A HREF>. Et il y a les liens vers les media à remettre en place. Je ne vous parle même pas de la coloration syntaxique qui, à ce jour, n'est toujours pas rétablie.</p>
<h2>Tentative pour les commentaires</h2>
<p>Evidemment, avec le passage du blog en fichiers statiques, je perds délibéremment la possibilité de mon audience de commenter et d'interargir avec mes posts.</p>
<p>Pourtant, sans trop y croire, je trouve une application qui fonctionne avec github, <a href="https://utteranc.es" target="_blank">Utterance</a>.</p>
<p>Je ne sais pas encore si ça marche, en même temps, mon blog étant en pause depuis si longtemps, je ne pense pas que qui que soit ait l'idée de commenter quoi que ce soit.</p>
<h2>Pipelines</h2>
<p>Le déploiement s'est donc passé sans souci. Drag &amp; Drop de mes fichiers HTML sur le serveur de prod, on ne peut pas dire que ce soit la chose la plus compliquée à faire. Il y a longtemps - TRES LONGTEMPS - que je n'ai déployé un site seulement en déplaçant les fichiers html sur le serveur.</p>
<p>Mais j'ai finalement deux repositories. Un premier repository, celui avec les fichiers d'eleventy et mes fichiers markdown. Et le second repository, obligatoire, comportant uniquement la version déployée du site (donc les fichiers html) pour que ça fonctionne avec Utterance.</p>
<p>Pour publier un post, il faut maintenant que je fasse</p>
<p>les fichiers mardown :</p>
<ol>
<li>écrire mon article en markdown</li>
<li>éventuellement préparer l'image qui va illustrer mon article</li>
<li>commiter le fichier markdown</li>
<li>lancer eleventy pour que le moteur génère la page html</li>
</ol>
<p>les fichiers html :</p>
<ol>
<li>commiter le fichier html</li>
<li>copier le fichier html sur le serveur de prod</li>
</ol>
<p>J'ai donc mis en place deux pipelines.</p>
<p>Le premier va pousser le fichier markdown sur mon premier repository, le second va pousser sur le second repository et copier les fichiers html sur le serveur de prod.</p>
<p>Et ceci est mon tout premier blog avec Eleventy.</p>
<p>*** EDIT ***
ok... j'ai un peu complexifié les choses avec mes deux dépôts. En fait, l'application Utterance ne fonctionne pas avec cette architecture. Je ne peux pas séparer les pages sources (.md) dans un dépôt et les pages finales (.hml) dans un second dépôt. Utterance ne retrouve pas ses petits... Je vais donc remettre tous les projets dans un seul dépôt - obligatoirement github.</p>
<p>J'avoue que je procrastine un peu</p>
</p>

      
        <div class="node-taxonomy">
          <h3><i class="fas fa-bookmark"></i>Tags</h3>
          <ul><li><a href="/fr/tags/next">next</a></li><li><a href="/fr/tags/resolutions">resolutions</a></li><li><a href="/fr/tags/eleventy">eleventy</a></li><li><a href="/fr/tags/jamstack">jamstack</a></li></ul>
        </div>
      

      
    

      


      <comment>
        <script src="https://utteranc.es/client.js"
          repo="haclong/petitspasdanslaneige"
          issue-term="title"
          label="Comment"
          theme="preferred-color-scheme"
          crossorigin="anonymous"
          async>
        </script>
      </comment>


    </article>



    </div>

    <!-- ----- End of DYNAMIC CONTENT ----- -->

  </main>

    
  <i id="scrolltop" class="fa fa-angle-up" onclick="gototop()"></i>

  <footer id="footer">
    <div class="container-xl">
      <h3>Sur moi</h3>
      <p>J&#39;ai appris le php il y a quelques années, quand Internet était à ses débuts. Pour diverses raisons, j&#39;ai arrêté en route et j&#39;ai perdu le fil des nouveaux Internets que je redécouvre. Résultat, je me sens constamment à courir après l&#39;histoire mais je suis toujours motivée à reprendre des projets personnels. Je me propose de vous partager mes découvertes. Au delà des sujets de programmation, j&#39;aime également partager mes infos concernant notamment l&#39;Histoire, l&#39;Astronomie, la Linguistique, les Films, les Livres et les Anime. J&#39;espère que vous aimerez suivre mon blog.</p>
      <!--div class="hr-double"></div-->
      <div class="bottomline">
        <p>&copy; 2012-2024 Haclong. Tous droits réservés.</p>
        <p>Propulsé par <a href="https://www.11ty.dev/" target="_blank">Eleventy</a></p>
      </div>
    </div>
  </footer>



  <!-- First JS scripts to be loaded -->
  <script src="/assets/scripts/bootstrap.js"></script>
  <!-- Last JS scripts to be loaded -->
  <script src="/assets/scripts/theme.js"></script>

</body>
</html>
